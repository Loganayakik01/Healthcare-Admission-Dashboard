Hospital Analytics SQL Views

This SQL script creates **analytic-ready views** on the hospital database, enabling **quick insights and reporting** without complex joins every time.

Key Views

1. **`vw_AdmissionDetails`**

   * Consolidates **patient, admission, department, doctor, branch, billing, and outcome data** into a single view.
   * Ideal for **executive dashboards** or **detailed admission analysis**.
   * Columns include:

     * Patient info (`patient_name`, `age`, `gender`)
     * Admission details (`admission_datetime`, `discharge_datetime`, `length_of_stay`, `is_readmission`)
     * Department, doctor, branch
     * Financial and outcome data (`total_cost`, `outcome`)

2. **`vw_DoctorWorkload`**

   * Summarizes **doctor utilization** based on procedures.
   * Tracks:

     * Total procedures performed
     * Actual hours spent
     * Utilization percentage vs available hours
   * Useful for **resource planning and workload balancing**.

 Example Queries

* `SELECT TOP 10 * FROM vw_DoctorWorkload;` → quickly identifies **most and least utilized doctors**.
* `SELECT TOP 3 * FROM bed_occupancy;` → monitors **critical bed occupancy snapshots** for operational alerts.

**Purpose:** Enables **self-service reporting**, **KPI tracking**, and **dashboarding** for hospital management without writing repetitive joins.
___________________________________________________________________________
Technical Steps:
Step 1: Connection Setup We established a connection using the pyodbc driver with the following connection string logic:
Python
connection_string = "DRIVER={ODBC Driver 17 for SQL Server};SERVER=YOUR_SERVER;DATABASE=HospitalAnalytics(create the database manually);Trusted_Connection=yes;"
Step 2: Automated Table Creation Using SQLAlchemy's create_engine, the synthetic data generated in generate_csv.py was pushed directly into SQL Server tables using the Pandas .to_sql() function.
Step 3: View Optimization Once the raw data was in SQL, we executed SQL Views (like vw_AdmissionDetails) to pre-join tables (Billing, Admissions, Doctors) for faster loading in Power BI.
Step 4: FastAPI Integration The API script connects to these same SQL tables to calculate live KPIs (like Bed Occupancy) and serves them as JSON endpoints.

